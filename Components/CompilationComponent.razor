@using Blazor.Diagrams.Components.Renderers;
@using Helix.Nodes

<style>
    .custom-node {
        min-width: 300px;
    }

    .custom-node .port {
        position: absolute;
        width: 20px;
        height: 20px;
        border-radius: 50%;
        background-color: #79bcdb;
        border: 3px solid #29A9E5;
        cursor: pointer;
        visibility: visible;
        transform: translate(-50%, -100%);
    }
    
    .custom-node .port.left {
        top: 50%;
        left: 0;
    }
    
    .custom-node .port:hover, .custom-node .port.has-links {
    background-color: black;
    }
</style>

<MudCard Class="pa-8 ma-0 darken-1 custom-node d-flex flex-column justify-center"
         @oncontextmenu:stopPropagation>
    <MudButton Class="mud-theme-primary" OnClick="OnCompile">
        Compile
    </MudButton>
    <MudTextField T="string"
                  DisableUnderLine="true"
                  Variant="Variant.Outlined" Lines="5"
                  @bind-Value="@Node.Text"
                  @onmousedown:stopPropagation @onmousemove:stopPropagation
                  @onwheel:stopPropagation/>
    @foreach (var port in Node.Ports)
    {
        <PortRenderer Port="port">
        </PortRenderer>
    }
</MudCard>

@code {
    [Parameter]
    public CompilationNode Node { get; set; }
    
    private void OnCompile()
    {
        // You couldn't see it, but I did some styling so the max width and height is taken up by the context menu.
        // Now the diagram canvas will use the entire free screen.
        
        // Great.
        // Now we can finally move to compilation.
        // Time to bring back F#!
        
        throw new NotImplementedException();
    }
}